---
layout: post
title: "Servlet"
subtitle: "Servlet 생명주기/동작과정"
date: 2021-01-31 20:25:00 +0900
background: '/img/posts/01.jpg'
categories: ['BackEnd','Spring']
---
# Servlet이란?
웹 기반의 요청에 대한 동적인 처리가 가능한 하나의 클래스.
- 클라이언트의 요청을 처리하고, 그 결과를 반환하는 Servlet 클래스의 구현 규칙을 지킨 자바 웹 프로그래밍 기술
- 쉽게 설명하면 클라이언트가 어떠한 요청을 하면 그에 대한 결과를 다시 전송해주어야 하는데, 이러한 역할을 하는 자바 프로그램

# Servlet의 생명주기(Lifecycle)
![image](https://user-images.githubusercontent.com/46861704/106377702-32255c00-63e2-11eb-8f23-9a17b1d66aa4.png)

1. 객체생성
   - 클라이언트의 적절한 요청에 따라 적절한 Servlet이 생성된다.
   - 생성시 객체는 메모리에 계속 존재하므로 새로운 객체가 생성되지 않고, 메모리에 있는 Servlet 객체를 사용한다.
2. init()
   - 객체 생성시 단 한번만 호출됨
3. Service()
   - 클라이언트의 요청이 있을 때 Service()가 GET, POST 여부에 따라 실행된다. 여러 클라이언트가 동시에 호출시에도 Thread가 생성되므로 동시에 Service()하여 수행속도가 빠르다.
   - HttpServlet을 상속받은 Servlet클래스에서 Service() 메서드를 오버라이드 하지 않았다면, 그 부모인 HttpServlet의 Service() 메서드가 호출된다.
     - Service() 메서드는 request의 타입에 따라 적절한 메스드(doGet, doPost, doPut, doDelete)를 호출한다.
     - 하위 메서드에 doGet, doPost등을 오버라이드하면 HttpServletdml Service() 메서드가 요청에 맞는 메서드를 알아서 호출한다.
   - 메서드가 return 하면 해당 Thread가 제거된다.
4. destroy()
   - 서블릿이 더 이상 필요 없을 경우(WAS 종료, Web Application 갱신 등) 호출되면서 Servlet 객체를 메모리에서 제거.

# Servlet의 동작과정
![image](https://user-images.githubusercontent.com/46861704/106377413-2c2e7b80-63e0-11eb-8c63-d80a7366c4b3.png)

1. 클라이언트가 웹 브라우저에 URL 입력 시 해당하는 HTTP Request를 해당하는 서버의 **Servlet Container**에 보낸다.
2. Servlet Container는 **HttpServletRequest**, **HttpServletResponse** 두 객체를 생성한다().
    - HttpServletRequest : 요청할 때 가지고 있는 정보를 저장하는 객체
    - HttpServletResponse : 응답을 보낼 때 사용하기 위한 객체
3. 클라이언트가 요청한 URL을 DD(배포서술자, Deplyment Descriptor)를 참조해서 분석하여 어느 서블릿에 대한 요청인지 찾는다.
4. Servlet Container는  service() 메소드를 호출하며, POST, GET 여부에 따라 doGet(), doPost() 등을 호출한다.
5. doGet(), doPost() 메소드는 동적인 페이지를 생성한 후 HttpServletResponse 객체에 응답을 보낸다.
6. 응답이 완료되면 HttpServletRequest, HttpServletResponse를 소멸시킨다.

# Servlet Container
Servlet Container는 말 그대로 서블릿을 관리해주는 컨테이너로, 아래와 같은 역할을 수행한다.
1. 서블릿 관리
   - 적절한 서블릿을 찾아 매칭, 생명주기 관리
2. 웹서버와 통신 지원
   - 컨테이너 내의 소켓을 통해 웹서버와 통신할수 있게 해줌
3. 요청에 따른 스레드 관리
   - 클라이언트의 요청들을 멀티스레드로 관리하여 처리
  
대표적인 Servlet Container로는 Tomcat, jetty, jboss 등이 있다.

# Reference
> - [[Web] Servlet이란](https://gmlwjd9405.github.io/2018/10/28/servlet.html)
> - [Servlet의 동작 과정 및 생명주기](https://hackersstudy.tistory.com/72)